<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExGPT - Admin Panel</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: 'Consolas', monospace; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å (–≤–µ—Ä–Ω—É–ª!) */
        .sidebar { width: 300px; border-right: 1px solid #333; display: flex; flex-direction: column; background: #050505; }
        .sidebar-header { padding: 15px; border-bottom: 1px solid #333; color: #00ff88; font-weight: bold; }
        #msg-list { flex: 1; overflow-y: auto; padding: 10px; font-size: 0.8rem; }
        .list-item { padding: 5px; border-bottom: 1px solid #111; color: #888; }

        /* –û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç */
        .main-content { flex: 1; display: flex; flex-direction: column; background: radial-gradient(circle at top, #1a1a1a, #050505); }
        .header { padding: 15px; text-align: center; border-bottom: 1px solid #333; background: rgba(0,0,0,0.5); }
        .header h1 { margin: 0; color: #00ff88; letter-spacing: 2px; }

        #chat-box { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 10px; }
        .msg { max-width: 75%; padding: 10px 15px; border-radius: 15px; font-size: 0.9rem; line-height: 1.4; animation: fadeIn 0.2s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .user-msg { background: #0044bb; align-self: flex-end; border-bottom-right-radius: 2px; }
        .admin-msg { background: #222; align-self: flex-start; border-bottom-left-radius: 2px; border: 1px solid #444; }
        .msg-info { font-size: 0.7rem; color: #aaa; margin-bottom: 3px; display: block; }
        .msg img { max-width: 100%; border-radius: 10px; margin-top: 5px; }

        /* –ü–æ–ª–µ –≤–≤–æ–¥–∞ */
        .input-area { padding: 20px; background: #0a0a0a; display: flex; gap: 10px; border-top: 1px solid #333; }
        input[type="text"] { flex: 1; background: #111; border: 1px solid #333; padding: 12px; border-radius: 5px; color: #00ff88; outline: none; }
        button { background: #00ff88; border: none; padding: 10px 20px; cursor: pointer; color: #000; font-weight: bold; }
        .file-label { background: #333; padding: 10px; cursor: pointer; display: flex; align-items: center; border-radius: 5px; }
        #file-input { display: none; }

        /* –í—Ö–æ–¥ */
        #login-screen { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; align-items: center; justify-content: center; flex-direction: column; }
    </style>
</head>
<body>

<div id="login-screen">
    <h2 style="color: #00ff88;">SYSTEM ACCESS</h2>
    <input type="text" id="userNameInput" placeholder="ENTER LOGON..." style="width: 250px; margin-bottom: 10px;">
    <button onclick="startChat()">EXECUTE</button>
</div>

<div class="sidebar">
    <div class="sidebar-header">DATABASE_LOGS</div>
    <div id="msg-list"></div>
</div>

<div class="main-content">
    <div class="header">
        <h1>ExGPT</h1>
        <p style="margin:0; font-size: 0.7rem; color: #666;">STATUS: ABSOLUTELY FREE</p>
    </div>

    <div id="chat-box"></div>

    <div class="input-area">
        <label class="file-label" for="file-input">üìé</label>
        <input type="file" id="file-input" accept="image/*" onchange="uploadFile(this)">
        <input type="text" id="messageInput" placeholder="Type message...">
        <button onclick="sendMessage()">SEND</button>
    </div>
</div>

<script>
    const firebaseConfig = {
        databaseURL: "https://exgpt-777-default-rtdb.europe-west1.firebasedatabase.app/" 
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let currentUserName = "";

    function startChat() {
        const name = document.getElementById('userNameInput').value.trim();
        if (name) {
            currentUserName = name;
            document.getElementById('login-screen').style.display = 'none';
        }
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –Ω–∞ ImgBB (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–µ–±—è)
    function uploadFile(input) {
        const file = input.files[0];
        if (!file) return;

        const formData = new FormData();
        formData.append("image", file);

        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–ª—è —Ç–µ—Å—Ç–æ–≤
        fetch("https://api.imgbb.com/1/upload?key=6d207e02198a847aa98d0a2a901485a5", {
            method: "POST",
            body: formData
        })
        .then(response => response.json())
        .then(result => {
            if (result.success) {
                db.ref('messages').push({
                    user: currentUserName,
                    text: result.data.url,
                    timestamp: Date.now()
                });
            }
        })
        .catch(error => console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:", error));
    }

    function isImgUrl(url) {
        return /\.(jpg|jpeg|png|webp|avif|gif)/.test(url);
    }

    function sendMessage() {
        const text = document.getElementById('messageInput').value.trim();
        if (text === "") return;

        db.ref('messages').push({
            user: currentUserName,
            text: text,
            timestamp: Date.now()
        });
        document.getElementById('messageInput').value = "";
    }

    db.ref('messages').on('child_added', (snapshot) => {
        const msg = snapshot.val();
        
        // 1. –î–æ–±–∞–≤–ª—è–µ–º –≤ –±–æ–∫–æ–≤—É—é –ø–∞–Ω–µ–ª—å (–õ–û–ì–ò)
        const listItem = document.createElement('div');
        listItem.className = 'list-item';
        listItem.textContent = `[${msg.user}]: ${msg.text.substring(0, 20)}...`;
        document.getElementById('msg-list').appendChild(listItem);

        // 2. –î–æ–±–∞–≤–ª—è–µ–º –≤ —á–∞—Ç
        const div = document.createElement('div');
        div.className = `msg ${msg.user === 'Aduse17' ? 'admin-msg' : 'user-msg'}`;
        
        let content = `<span class="msg-info">${msg.user}</span>`;
        if (isImgUrl(msg.text)) {
            content += `<img src="${msg.text}">`;
        } else {
            content += `<span>${msg.text}</span>`;
        }
        
        div.innerHTML = content;
        document.getElementById('chat-box').appendChild(div);
        document.getElementById('chat-box').scrollTop = document.getElementById('chat-box').scrollHeight;
    });

    document.getElementById('messageInput').addEventListener("keypress", (e) => {
        if (e.key === "Enter") sendMessage();
    });
</script>

</body>
</html>
