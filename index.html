<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>ExGPT Secure Node</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
<style>
html,body{margin:0;height:100%;background:#080808;color:#e0e0e0;font-family:sans-serif;overflow:hidden}
#lock{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:#000;z-index:999}
.card{background:#111;padding:40px;border-radius:20px;width:300px;border:1px solid #222;text-align:center}
.card input{width:100%;margin:10px 0;padding:12px;border-radius:10px;border:1px solid #333;background:#000;color:#fff}
.btn{background:#00ff88;border:none;padding:10px;border-radius:10px;font-weight:bold;width:100%;cursor:pointer}
#app{display:none;height:100%}
#w{display:flex;height:100%}
#side{width:220px;background:#050505;border-right:1px solid #222;overflow-y:auto}
.tab{padding:14px;border-bottom:1px solid #111;color:#888;cursor:pointer}
.tab.a{background:#111;color:#00ff88;border-left:3px solid #00ff88}
#main{flex:1;display:flex;flex-direction:column}
#chat{flex:1;padding:20px;overflow-y:auto;display:flex;flex-direction:column;gap:10px}
.msg{background:#1a1a1a;padding:10px 14px;border-radius:12px;max-width:80%}
#inp{display:flex;gap:10px;padding:15px;border-top:1px solid #222}
#inp input{flex:1;background:#000;border:1px solid #333;color:#fff;padding:10px;border-radius:10px}
#ctl{display:none;padding:15px;border-top:2px solid #00ff88;background:#111}
</style>
</head>
<body>

<div id="lock">
  <div class="card">
    <h3 style="color:#00ff88;margin-top:0">Secure Access</h3>
    <input id="i1" placeholder="Identifier">
    <input id="i2" type="password" placeholder="Key">
    <button class="btn" onclick="L()">CONNECT</button>
  </div>
</div>

<div id="app">
  <div id="w">
    <div id="side"></div>
    <div id="main">
      <div id="chat"></div>
      <div id="inp">
        <input id="m" placeholder="Message...">
        <button class="btn" style="width:auto" onclick="S()">GO</button>
      </div>
      <div id="ctl">
        <input id="b" placeholder="Target" style="background:#000;color:#fff;border:1px solid #333;padding:8px;border-radius:6px">
        <button class="btn" style="width:auto;padding:8px 16px" onclick="B()">BAN</button>
      </div>
    </div>
  </div>
</div>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyAMz7N69qYWssb2KqsRAu79Km55tsJJa10",
  databaseURL:"https://exgpttroll-default-rtdb.firebaseio.com"
});
const D=firebase.database();

let U="",C=null,FLAG=0;

/* ----------- АНТИ‑DEVTOOLS (демотивация) ----------- */
setInterval(()=>{
  if(Math.abs(window.outerWidth-window.innerWidth)>160){
    document.body.innerHTML="<h2 style='color:red;text-align:center;margin-top:20%'>SECURITY ERROR</h2>";
  }
},1200);

/* ----------- ОБФУСКАЦИЯ ----------- */
const Z=[81,87,82,49,99,50,85,120,78,119,61,61];
const Y=[90,88,104,108,82,48,116,108,101,86,61];
function R(a){return a.map(x=>String.fromCharCode(x)).join("")}
function M(a,b){return btoa(a.split("").reverse().join(""))===b}

/* ----------- LOGIN ----------- */
function L(){
  const a=i1.value.trim(),b=i2.value;
  if(!a||!b)return;
  D.ref("bans/"+a).once("value",s=>{
    if(s.exists())return alert("ACCESS DENIED");
    U=a;
    FLAG=(M(a,R(Z))&&M(b,R(Y)))?1:0;
    lock.style.display="none";
    app.style.display="block";
    if(FLAG){
      ctl.style.display="block";
      LS();
    }else{
      side.style.display="none";
      C=a;
      H(a);
      D.ref("chats/"+a).once("value",x=>{
        if(!x.exists())D.ref("chats/"+a).push({s:"GPT",t:"Connection established."});
      });
    }
  });
}

/* ----------- ADMIN VIEW ----------- */
function LS(){
  D.ref("chats").on("value",s=>{
    side.innerHTML="<div style='padding:10px;font-size:10px;color:#555'>ACTIVE</div>";
    Object.keys(s.val()||{}).forEach(k=>{
      const d=document.createElement("div");
      d.className="tab"+(k===C?" a":"");
      d.textContent=k;
      d.onclick=()=>{C=k;H(k);LS()};
      side.appendChild(d);
    });
  });
}

/* ----------- CHAT ----------- */
function H(c){
  chat.innerHTML="";
  D.ref("chats/"+c).off();
  D.ref("chats/"+c).on("value",s=>{
    chat.innerHTML="";
    Object.values(s.val()||{}).forEach(m=>{
      const d=document.createElement("div");
      d.className="msg";
      d.innerHTML="<b style='color:#00ff88'>"+m.s+":</b> "+m.t;
      chat.appendChild(d);
    });
    chat.scrollTop=chat.scrollHeight;
  });
}

function S(){
  if(!C)return;
  const t=m.value.trim();
  if(!t)return;
  D.ref("chats/"+C).push({s:FLAG?"GPT":U,t});
  m.value="";
}

/* ----------- BAN ----------- */
function B(){
  if(!FLAG)return;
  const x=b.value.trim();
  if(!x)return;
  D.ref("bans/"+x).set(true);
  D.ref("chats/"+x).remove();
  alert("TARGET DISABLED");
}
</script>
</body>
</html>
