<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>ExGPT Secure Node</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
<style>
html,body{margin:0;height:100%;background:#080808;color:#e0e0e0;font-family:sans-serif;overflow:hidden}
#lock{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:#000;z-index:999}
.card{background:#111;padding:40px;border-radius:20px;width:300px;border:1px solid #222;text-align:center}
.card input{width:100%;margin:10px 0;padding:12px;border-radius:10px;border:1px solid #333;background:#000;color:#fff;outline:none}
.btn{background:#00ff88;border:none;padding:10px;border-radius:10px;font-weight:bold;width:100%;cursor:pointer;color:#000}
#app{display:none;height:100%}
#w{display:flex;height:100%}
#side{width:220px;background:#050505;border-right:1px solid #222;overflow-y:auto}
.tab{padding:14px;border-bottom:1px solid #111;color:#888;cursor:pointer}
.tab.a{background:#111;color:#00ff88;border-left:3px solid #00ff88}
#main{flex:1;display:flex;flex-direction:column}
#chat{flex:1;padding:20px;overflow-y:auto;display:flex;flex-direction:column;gap:10px}
.msg{background:#1a1a1a;padding:10px 14px;border-radius:12px;max-width:80%}
#inp{display:flex;gap:10px;padding:15px;border-top:1px solid #222;background:#080808}
#inp input{flex:1;background:#000;border:1px solid #333;color:#fff;padding:10px;border-radius:10px}
#ctl{display:none;padding:15px;border-top:2px solid #00ff88;background:#111}
#sec-lock{position:fixed;inset:0;background:#000;color:red;display:none;align-items:center;justify-content:center;z-index:9999;font-size:22px;text-align:center;}
</style>
</head>
<body>

<div id="sec-lock">SECURITY LOCKED<br>ACCESS TERMINATED</div>

<div id="lock">
  <div class="card">
    <h3 style="color:#00ff88;margin-top:0">Secure Access</h3>
    <input id="i1" placeholder="Identifier">
    <input id="i2" type="password" placeholder="Key">
    <button class="btn" onclick="LOGIN()">CONNECT</button>
  </div>
</div>

<div id="app">
  <div id="w">
    <div id="side"></div>
    <div id="main">
      <div id="chat"></div>
      <div id="inp">
        <input id="m" placeholder="Message...">
        <button class="btn" style="width:auto;padding:0 20px" onclick="SEND()">GO</button>
      </div>
      <div id="ctl">
        <input id="b" placeholder="Target" style="background:#000;color:#fff;border:1px solid #333;padding:8px;border-radius:6px">
        <button class="btn" style="width:auto;padding:8px 16px" onclick="BAN()">BAN</button>
      </div>
    </div>
  </div>
</div>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyAMz7N69qYWssb2KqsRAu79Km55tsJJa10",
  databaseURL: "https://exgpttroll-default-rtdb.firebaseio.com"
});
const DB = firebase.database();

let USER="", CHAT=null, ADMIN=false, LOCKED=false;

const A=[65,100,117,115,101,49,55];
const P=[101,120,101,71,75,101,121,81];
const STR=a=>a.map(x=>String.fromCharCode(x)).join("");

function SECURITY_LOCK(){
  if(LOCKED || ADMIN) return;
  LOCKED=true;
  document.getElementById("sec-lock").style.display="flex";
}

setInterval(()=>{
  if(!ADMIN && Math.abs(window.outerWidth-window.innerWidth)>160){
    SECURITY_LOCK();
  }
},1500);

document.addEventListener("keydown",e=>{
  if(ADMIN) return;
  if(e.key==="F12" || (e.ctrlKey && e.shiftKey && ["I","J"].includes(e.key)) || (e.ctrlKey && e.key==="U")){
    e.preventDefault();
    SECURITY_LOCK();
  }
});

function LOGIN(){
  const u=i1.value.trim();
  const p=i2.value;
  if(!u||!p) return;

  DB.ref("bans/"+u).once("value",s=>{
    if(s.exists()) return alert("ACCESS DENIED");

    USER=u;
    ADMIN=(u===STR(A) && p===STR(P));

    lock.style.display="none";
    app.style.display="block";

    if(ADMIN){
      ctl.style.display="block";
      LOAD_CHATS();
    }else{
      side.style.display="none";
      CHAT=u;
      LISTEN(u);
      DB.ref("chats/"+u).once("value",x=>{
        if(!x.exists()){
          DB.ref("chats/"+u).push({s:"GPT",t:"Connection established."});
        }
      });
    }
  });
}

function LOAD_CHATS(){
  DB.ref("chats").on("value",s=>{
    side.innerHTML="<div style='padding:10px;font-size:10px;color:#555'>ACTIVE</div>";
    Object.keys(s.val()||{}).forEach(k=>{
      const d=document.createElement("div");
      d.className="tab"+(k===CHAT?" a":"");
      d.textContent=k;
      d.onclick=()=>{CHAT=k;LISTEN(k);LOAD_CHATS()};
      side.appendChild(d);
    });
  });
}

function LISTEN(c){
  const win = document.getElementById("chat");
  DB.ref("chats/"+c).off();
  DB.ref("chats/"+c).on("value",s=>{
    win.innerHTML="";
    Object.values(s.val()||{}).forEach(m=>{
      const d = document.createElement("div");
      d.className="msg";
      d.innerHTML="<b style='color:#00ff88'>"+m.s+":</b> "+m.t;
      win.appendChild(d);
    });
    win.scrollTop=win.scrollHeight;
  });
}

function SEND(){
  if(!CHAT) return;
  const t=m.value.trim();
  if(!t) return;
  DB.ref("chats/"+CHAT).push({s:ADMIN?"GPT":USER,t:t});
  m.value="";
}

function BAN(){
  if(!ADMIN) return;
  const x=b.value.trim();
  if(!x) return;
  DB.ref("bans/"+x).set(true);
  DB.ref("chats/"+x).remove();
  alert("TARGET DISABLED");
}
</script>
</body>
</html>
