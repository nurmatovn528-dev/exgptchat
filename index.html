<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExGPT - Official</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        /* –í–û–ó–í–†–ê–©–ê–ï–ú –¢–û–¢ –°–ê–ú–´–ô –î–ò–ó–ê–ô–ù */
        body { background: radial-gradient(circle at top, #1a1a1a, #050505); color: #fff; font-family: 'Inter', -apple-system, sans-serif; height: 100vh; margin: 0; display: flex; flex-direction: column; }
        
        #login-screen { position: fixed; inset: 0; background: #050505; display: flex; align-items: center; justify-content: center; z-index: 1000; flex-direction: column; }
        .login-card { background: #111; padding: 40px; border-radius: 20px; border: 1px solid #333; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .login-card h2 { color: #00ff88; margin-top: 0; }
        
        .header { background: rgba(20, 20, 20, 0.8); backdrop-filter: blur(10px); padding: 15px; text-align: center; border-bottom: 1px solid #333; }
        .header h1 { margin: 0; font-size: 1.5rem; letter-spacing: 2px; color: #00ff88; text-shadow: 0 0 10px rgba(0,255,136,0.3); }
        .header p { margin: 5px 0 0; font-size: 0.75rem; color: #666; text-transform: uppercase; }

        #chat-box { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; scroll-behavior: smooth; }
        .msg { max-width: 75%; padding: 12px 18px; border-radius: 18px; font-size: 0.95rem; line-height: 1.5; position: relative; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* –°—Ç–∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∫–∞–∫ –≤ —É–¥–∞—á–Ω–æ–π –≤–µ—Ä—Å–∏–∏ */
        .user-msg { background: linear-gradient(135deg, #0066ff, #0044bb); align-self: flex-end; border-bottom-right-radius: 2px; box-shadow: 0 4px 15px rgba(0,102,255,0.2); }
        .admin-msg { background: #222; align-self: flex-start; border-bottom-left-radius: 2px; border: 1px solid #333; }
        .msg-info { font-size: 0.7rem; color: #888; margin-bottom: 4px; display: block; }
        .msg img { max-width: 100%; border-radius: 12px; margin-top: 8px; border: 1px solid #444; }

        .input-container { background: #111; padding: 20px; border-top: 1px solid #222; display: flex; gap: 12px; align-items: center; }
        input[type="text"] { flex: 1; background: #1a1a1a; border: 1px solid #333; padding: 14px 20px; border-radius: 30px; color: white; outline: none; transition: 0.3s; }
        
        button { background: #00ff88; border: none; padding: 12px 25px; border-radius: 30px; color: #000; font-weight: 700; cursor: pointer; transition: 0.3s; }
        button:hover { background: #00cc6e; transform: translateY(-2px); }
        
        .attach-btn { background: #222; color: #888; border: 1px solid #333; padding: 12px 15px; border-radius: 50%; cursor: pointer; }
        #file-input { display: none; }
    </style>
</head>
<body>

<div id="login-screen">
    <div class="login-card">
        <h2>ExGPT</h2>
        <p style="color: #888;">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø—Å–µ–≤–¥–æ–Ω–∏–º</p>
        <input type="text" id="userNameInput" placeholder="–í–∞—à–µ –∏–º—è..." style="margin-bottom: 20px; width: 80%; background: #1a1a1a; border: 1px solid #333; padding: 10px; color: white; border-radius: 10px;">
        <br>
        <button onclick="startChat()">–í–æ–π—Ç–∏</button>
    </div>
</div>

<div class="header">
    <h1>ExGPT</h1>
    <p>–ê–±—Å–æ–ª—é—Ç–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</p>
</div>

<div id="chat-box"></div>

<div class="input-container">
    <label class="attach-btn" for="file-input">üìé</label>
    <input type="file" id="file-input" accept="image/*" onchange="uploadFile(this)">
    <input type="text" id="messageInput" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ...">
    <button onclick="sendMessage()">‚Üí</button>
</div>

<script>
    const firebaseConfig = {
        databaseURL: "https://exgpt-777-default-rtdb.europe-west1.firebasedatabase.app/" 
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let currentUserName = "";

    function startChat() {
        const name = document.getElementById('userNameInput').value.trim();
        if (name) {
            currentUserName = name;
            document.getElementById('login-screen').style.display = 'none';
        }
    }

    // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø –ó–ê–ì–†–£–ó–ö–ò –§–ê–ô–õ–ê
    function uploadFile(input) {
        const file = input.files[0];
        if (!file) return;

        const formData = new FormData();
        formData.append("image", file);

        fetch("https://api.imgbb.com/1/upload?key=6d207e02198a847aa98d0a2a901485a5", {
            method: "POST",
            body: formData
        })
        .then(r => r.json())
        .then(res => {
            if (res.success) {
                db.ref('messages').push({
                    user: currentUserName,
                    text: res.data.url,
                    timestamp: Date.now()
                });
            }
        });
    }

    function isImgUrl(url) {
        return /\.(jpg|jpeg|png|webp|avif|gif)/.test(url);
    }

    function sendMessage() {
        const text = document.getElementById('messageInput').value.trim();
        if (text === "") return;

        db.ref('messages').push({
            user: currentUserName,
            text: text,
            timestamp: Date.now()
        });
        document.getElementById('messageInput').value = "";
    }

    db.ref('messages').on('child_added', (snapshot) => {
        const msg = snapshot.val();
        const div = document.createElement('div');
        
        // –ü–†–û–í–ï–†–ö–ê –ù–ê –¢–í–û–ô –ù–ò–ö
        div.className = `msg ${msg.user === 'Aduse17' ? 'admin-msg' : 'user-msg'}`;
        
        let content = `<span class="msg-info">${msg.user}</span>`;
        if (isImgUrl(msg.text)) {
            content += `<img src="${msg.text}">`;
        } else {
            content += `<span>${msg.text}</span>`;
        }
        
        div.innerHTML = content;
        document.getElementById('chat-box').appendChild(div);
        document.getElementById('chat-box').scrollTop = document.getElementById('chat-box').scrollHeight;
    });

    document.getElementById('messageInput').addEventListener("keypress", (e) => {
        if (e.key === "Enter") sendMessage();
    });
</script>

</body>
</html>
